<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>This Place Will Be Desert</title>
    <!-- Include Leaflet -->
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.5.1/dist/leaflet.css"
      integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="
      crossorigin=""
    />
    <script
      src="https://unpkg.com/leaflet@1.5.1/dist/leaflet.js"
      integrity="sha512-GffPMF3RvMeYyc1LWMHtK8EbPv0iNZ8/oTtHPx9/cc2ILxQ+u905qIwdpULaqDkyBKgOaB57QTMg7ztg8Jm2Og=="
      crossorigin=""
    ></script>
    <!-- Include CARTO.js -->
    <script src="https://libs.cartocdn.com/carto.js/v4.1.11/carto.min.js"></script>
    <!-- <link
      href="https://carto.com/developers/carto-js/examples/maps/public/style.css"
      rel="stylesheet"
    /> -->

    <link rel="stylesheet" href="style.css" />
  </head>

  <body>
    <header>
      <h1>
        <span>This </span>
        <span>Place </span>
        <span>Will </span>
        <span>Be </span>
        <span>Test</span>
      </h1>
      <p>
        See how the climate is changing where you live.<br />
        Demand action on climate change.
      </p>
    </header>

    <!-- Map -->
    <section>
      <div id="controls">
        <ul>
          <li onclick="set2000()">
            <input type="radio" name="source" checked id="2000" />
            <label for="2000">2000</label>
          </li>
          <li onclick="set2060()">
            <input type="radio" name="source" id="2060" />
            <label for="2060">2060</label>
          </li>
        </ul>
      </div>
      <div id="map"></div>
    </section>
    <section id="explainer" class="container">
      <!-- <iframe
        width="100%"
        height="520"
        frameborder="0"
        src="https://jleland00.carto.com/builder/c2125258-de42-4666-816c-997d75114f18/embed"
        allowfullscreen
        webkitallowfullscreen
        mozallowfullscreen
        oallowfullscreen
        msallowfullscreen
      ></iframe> -->

      <small>
        Source: Tree Cover and Aridity Projections to 2060, US Forest Service,
        2010
      </small>

      <ul>
        <li>
          <div></div>
          <h3>Humid</h3>
          <p>TKTK</p>
        </li>
        <li>
          <div></div>
          <h3>Dry Subhumid</h3>
          <p>TKTK</p>
        </li>
        <li>
          <div></div>
          <h3>Semi-arid</h3>
          <p>
            Semi-arid regions usually can't support forests or large vegetation
            because of limited precipitation. This climate tends to support
            short or scrubby vegetation and are usually dominated by either
            grasses or shrubs.
          </p>
        </li>
        <li>
          <div></div>
          <h3>Arid</h3>
          <p>
            A region is arid when it is characterized by a severe lack of
            available water, to the extent of hindering the growth and
            development of plant and animal life. Environments subject to arid
            climates tend to lack vegetation and are characterized by excessive
            heat and inadequate, variable precipitation.
          </p>
        </li>
        <li>
          <div></div>
          <h3>Hyperarid</h3>
          <p>
            Barren and unproductive land characterized by an extreme lack of
            participation or moisture that prevents nearly all growth or
            development of plant and animal life.
          </p>
        </li>
      </ul>

      <p class="container">
        The climate is changing fast. While sea level rise gets the most
        attention, it’s actually one of the slowest moving impacts of climate
        change. This century, well within the lifetime of ourselves and our
        children, the climate that we live in will change. Large areas of
        America are in danger of becoming more arid as weather patterns change
        and less rain falls every year. This will thin our forests, dramatically
        reduce agricultural yields, and change the very nature of the places we
        live. The stakes have never been higher and the time to act is now.
      </p>
    </section>

    <footer class="container">
      <h2>This Place Will Be Desert</h2>
      <p>
        This Place Will Be Desert is a participatory project to bring attention
        to the coming impacts of climate change in communities that will be
        impacted. We are collaborating with artists to design stickers and
        posters that can be placed in regions that are threatened with severe
        climatic change to raise awareness about climate change impacts and
        motivate people to push for the political and systemic change required
        to address the crisis. We are launching the campaign in Fall 2019 as a
        part of Climate Week. If you’re interested in participating or writing
        about the campaign,
        <a
          href="mailto:jbleland@gmail.com?subject=This%20Place%20Will%20Be%20Desert"
          >get in touch</a
        >.
      </p>
    </footer>

    <script>
      // Initiate Leaflet map
      const cornerTopLeft = L.latLng(48.16, -124.0);
      const cornerBottomRight = L.latLng(24.28, -66.44);
      const bounds = L.latLngBounds(cornerTopLeft, cornerBottomRight);
      const map = L.map("map", {
        zoomControl: false,
        attributionControl: false,
        scrollWheelZoom: false,
        boxZoom: false,
        doubleClickZoom: false,
        scrollWheelZoom: false,
        dragging: false
      }).fitBounds(bounds);

      L.tileLayer(
        "https://{s}.basemaps.cartocdn.com/rastertiles/voyager_nolabels/{z}/{x}/{y}.png",
        {
          maxZoom: 18
        }
      ).addTo(map);

      // Set up Carto API
      const client = new carto.Client({
        apiKey: `MAP_API_KEY`,
        username: `MAP_USERNAME`
      });

      // Set intial 2000 aridity map polygons
      const source = new carto.source.SQL("SELECT * FROM table_2000_aridity");
      const style = new carto.style.CartoCSS(`
          #layer {
            polygon-fill: ramp([column_2000_aridity_zone], (#52c406, #ffd52b, #268455, #ec650a, #73AF48, #e41b04, #666666), ("Dry Subhumid", "Semi-Arid", "Humid", "Arid", null, "Hyperarid"), "=");
          }
        `);
      const aridityLayer = new carto.layer.Layer(source, style);

      // Talk to checkboxes
      function set2000() {
        source.setQuery("SELECT * FROM table_2000_aridity");
        style.setContent(`
          #layer {
            polygon-fill: ramp([column_2000_aridity_zone], (#52c406, #ffd52b, #268455, #ec650a, #73AF48, #e41b04, #666666), ("Dry Subhumid", "Semi-Arid", "Humid", "Arid", null, "Hyperarid"), "=");
          }
        `);
      }

      function set2060() {
        source.setQuery("SELECT * FROM table_2060_aridity");
        style.setContent(`
          #layer {
            polygon-fill: ramp([column_2060_projection], (#52c406, #ffd52b, #268455, #ec650a, #73AF48, #e41b04, #666666), ("Dry Subhumid", "Semi-Arid", "Humid", "Arid", null, "Hyperarid"), "=");
          }
        `);
      }

      // Set state outlines
      const outlineSource = new carto.source.SQL(
        "SELECT * FROM ne_50m_admin_1_states"
      );
      const outlineStyle = new carto.style.CartoCSS(`
        #layer {
          polygon-fill: #826dba;
          polygon-opacity: 0;
        }
        #layer::outline {
          line-comp-op: soft-light;
          line-width: 2;
          line-color: #FFFFFF;
          line-opacity: 1;
        }
        `);
      const outlineLayer = new carto.layer.Layer(outlineSource, outlineStyle);

      // Add aridity layer to map
      client.addLayer(aridityLayer);

      // Add outline layer to map
      client.addLayer(outlineLayer);

      // Add map to page
      client.getLeafletLayer().addTo(map);
    </script>
  </body>
</html>
